#include <16f877a.h>
#fuses XT
#use delay(clock=4M)
/*******************/
#byte trisb = 0x86
#byte portb = 0x06
/*******************/
#bit C1 = portb.5
#bit C2 = portb.6
#bit C3 = portb.7
#bit F1 = portb .0
#bit F2 = portb .1
#bit F3 = portb .2
#bit F4 = portb .3
/*******************/
#define LCD_ENABLE_PIN  PIN_D3
#define LCD_RS_PIN      PIN_D1
#define LCD_RW_PIN      PIN_D2
#define LCD_DATA4       PIN_D4
#define LCD_DATA5       PIN_D5
#define LCD_DATA6       PIN_D6
#define LCD_DATA7       PIN_D7
#include <lcd.c>
/*******************/
int key;

void keyDetection(){
    C1 = 1;
    if (F1 == 1){key = 1;}
    if (F2 == 1){key = 4;}
    if (F3 == 1){key = 7;}
    if (F4 == 1){key = "A";}
    C1 = 0;

    C2 = 1;
    if (F1 == 1){key = 2;}
    if (F2 == 1){key = 5;}
    if (F3 == 1){key = 8;}
    if (F4 == 1){key = 0;}
    C2 = 0;

    C3 = 1;
    if (F1 == 1){key = 3;}
    if (F2 == 1){key = 6;}
    if (F3 == 1){key = 9;}
    if (F4 == 1){key = "C";}
    C3 = 0;
}

void main(){
    trisb = 0b11100000;

    lcd_init();
    lcd_gotoxy(1, 1);
    lcd_putc("  ENCENDIDO DE  ");
    lcd_gotoxy(1, 2);
    lcd_putc("    MOTOR DC    ");
    delay_ms(800);
    lcd_putc("\f");

    lcd_gotoxy(1, 1);
    lcd_putc("MOTOR: OFF");
    while(true){
        keyDetection();

        lcd_gotoxy(1, 2);
        printf(lcd_putc, "Tiempo: %02s", key);
    }
}