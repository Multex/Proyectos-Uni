#include <16f877a.h>
#fuses xt
#use delay(clock = 4M)
#byte trisb = 0x86
#byte trisc = 0x87
#byte portb = 0x06
#byte portc = 0x07

#define INCREMENTO portc.0
#define MULTIPLICAR portc.1
#define UNI portc.2
#define DEC portc.3

#define CERO 0b11000000
#define UNO 0b11111001
#define DOS 0b10100100
#define TRES 0b10110000
#define CUATRO 0b10011001
#define CINCO 0b10010010
#define SEIS 0b10000010
#define SIETE 0b11111000
#define OCHO 0b10000000
#define NUEVE 0b10010000

#define FACTOR 6

void mostrar_numero(int numero) {
   int unidades = numero % 10;
   int decenas = numero / 10;
   int datos[10] = {CERO, UNO, DOS, TRES, CUATRO, CINCO, SEIS, SIETE, OCHO, NUEVE};
   
   
   DEC = 1;
   portb = datos[decenas];
   delay_ms(50);
   DEC = 0;
   UNI = 1;
   portb = datos[unidades];
   delay_ms(50);
   UNI = 0;
}

void leer_pulsadores(int *contador) {
   if(INCREMENTO == 0) {
      (*contador)++;
      mostrar_numero(*contador);
      while(INCREMENTO == 0) { }
      if(*contador == 10) {*contador = 0;}
   }
   
   if(MULTIPLICAR == 0) {
      delay_ms(2000);
      *contador = *contador * FACTOR;
      for(int t=0; t<30; t++) {
         mostrar_numero(*contador);
      }
   }
}

void main() {
   trisb = 0b00000000;
   trisc = 0b00000011;
   
   int contador = 0;
   
   portb = 0b00000000;
   portc = 0b00000000;
   
   while(true) {
      UNI = 1;
      mostrar_numero(contador);
      leer_pulsadores(&contador);
   }
}

